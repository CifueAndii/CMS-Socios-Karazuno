{% extends "base.html" %}
{% load static %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block extra_head %}
  <!-- DataTables + Tailwind -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.tailwindcss.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
{% endblock %}

{% block content %}
<div class="container mx-auto px-6 py-10">
  <h1 class="text-4xl font-extrabold text-gray-800 mb-4 text-center"> Tabla de Posiciones</h1>

  {% for deporte, equipos in equipos_por_deporte.items %}
    <div class="mb-16">
      <h2 class="text-2xl font-semibold mb-4 text-red-600 border-b-2 border-red-500 pb-2">{{ deporte }}</h2>

      {% if equipos %}
        <div class="overflow-x-auto shadow-xl rounded-lg bg-white p-4">
          <table id="tabla-{{ forloop.counter }}" class="min-w-full divide-y divide-gray-200">
            <thead class="bg-red-600 text-white">
              <tr>
                <th class="py-3 px-4 text-left">Equipo</th>
                <th class="py-3 px-4 text-center">PJ</th>
                <th class="py-3 px-4 text-center">G</th>
                <th class="py-3 px-4 text-center">E</th>
                <th class="py-3 px-4 text-center">P</th>
                <th class="py-3 px-4 text-center">Puntos</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
              {% for equipo in equipos %}
                <tr class="hover:bg-red-50 transition">
                  <td class="py-2 px-4 font-medium text-gray-800">{{ equipo.nombre }}</td>
                  <td class="py-2 px-4 text-center">{{ equipo.partidos_jugados }}</td>
                  <td class="py-2 px-4 text-center">{{ equipo.ganados }}</td>
                  <td class="py-2 px-4 text-center">{{ equipo.empatados }}</td>
                  <td class="py-2 px-4 text-center">{{ equipo.perdidos }}</td>
                  <td class="py-2 px-4 text-center font-bold text-gray-800">{{ equipo.puntos }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p class="text-gray-500 italic">No hay equipos cargados para este deporte.</p>
      {% endif %}
    </div>
  {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener("DOMContentLoaded", function() {
    $("table[id^='tabla-']").each(function() {
      $(this).DataTable({
        language: {
          search: "üîç Buscar:",
          lengthMenu: "Mostrar _MENU_ Equipos por p√°gina",
          info: "Mostrando _START_ a _END_ de _TOTAL_ equipos",
          infoEmpty: "No hay equipos disponibles",
          zeroRecords: "No se encontraron resultados",
        },
        pageLength: 5,
        ordering: true,
        responsive: true,
        order: [[5, "desc"]],
      });
    });
  });
</script>
{% endblock %}
